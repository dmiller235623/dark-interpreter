* working notes

audio.c hardware.c mainbuffer.c datagen.c

with headers...

* programming

: PATH=~/sat/bin:$PATH
: PATH=~/stm32f4/stlink/flash:$PATH

: make stlink_flash

connection on own board is VDD, SCLCK, SWDIO, GND (so last 2 are
swapped from STLINK board)

* TODO:

0- all code structure with headers

1-audio codec/left and right

2-hardware switches

2.5-test audio in/out straight DONE but 4053 seems not quite right RETEST. FIXED

3-/buffer treatment

(read from lists of grain size and position, what to do if fill buffer
part way through grain?)

4-PWM

5-filter and hardware

6-datagens - backwards, code chunks, symmetry, code direction and recoding

7-stack/frame

8-fingers//EEG//LM358IN

* older code notes

** TODO 20.8.2013+

- [top board hardware assembled (missing 470nF????)]

- test straight audio out/read potis/switch all signal paths
- tests for finger incoming/EEG signals
- port all code/new code
- finishing touches

** code

DI code: file:latestresearch/sc3-plugins-src-2012-05-26/source/SLUGens

[[file:collect2012-3/dark-interpreter/src/main.c][file:~/collect2012-3/dark-interpreter/src/main.c]]

./audio.h:13:#define BUFF_LEN 128

48000 samples per second = 375 buffs per second (1/375 sec per buf)

- check out callbacks and how we handle these

2 callbacks (half and full buffer)

I2S_RX_CallBack(src, dst, sz, 0); with sz as half of BUFF_LEN    

callback is in:

[[file:collect2012-3/dark-interpreter/src/audio_delay.c::void%20I2S_RX_CallBack%20int16_t%20src%20int16_t%20dst%20int16_t%20sz%20uint16_t%20ht][file:collect2012-3/dark-interpreter/src/audio_delay.c::void I2S_RX_CallBack int16_t src int16_t dst int16_t sz uint16_t ht]]

 src = (int16_t *)(rxbuf) + sz;
 dst = (int16_t *)(txbuf) + sz;

is rxbuf sound in, txbuf out and how does delay code work with buffers?

yes looks like. how to adapt to write/read individual locations from large buffer

-is 128 our smallest grain size or do we change this?
-array of sample locations for each sample (generated by main code)


- big buffer or 3x buffer
- macro-micro
- port micro-bd/wormcode

- note 3 blocks SRAM : 112KB + 16KB + 64KB (ccmdata see delay code)

see code also in
[[file:latestresearch/sc3-plugins-src-2012-05-26/source/SLUGens/SLUGens.cpp::void%20FitzHughNagumo_next_k%20FitzHughNagumo%20unit%20int%20inNumSamples][file:latestresearch/sc3-plugins-src-2012-05-26/source/SLUGens/SLUGens.cpp::void
FitzHughNagumo_next_k FitzHughNagumo unit int inNumSamples]]

 )

see also: http://doc.sccode.org/Classes/FitzHughNagumo.html

also Oregonator (reaction.diff), brusselator...
